import java.nio.file.Paths;
import java.util.Arrays;

public class ExploitationTests {
    /**
     * Test Exploitation main function
     *
     * @param args - command flags
     */
    public static void main(String[] args) {
        init();
        testSolutionLong();
        testSolutionShort();
    }

    /**
     * Initialization
     */
    private static void init() {
        String messagePathLong = "D:/testFiles/message_long";
        String messagePathShort = "D:/testFiles/message_short";
        String cipherPathLong = "D:/testFiles/cipher_long";
        String cipherPathShort = "D:/testFiles/cipher_short";
        byte[][] testKeys = Tools.exploit(Paths.get(messagePathLong), Paths.get(cipherPathLong));
        byte[] testExploitation = Tools.combine(testKeys);
        Tools.writeToFile(Paths.get("D:/testFiles/myKeysLong"), testExploitation);
        testKeys = Tools.exploit(Paths.get(messagePathShort), Paths.get(cipherPathShort));
        testExploitation = Tools.combine(testKeys);
        Tools.writeToFile(Paths.get("D:/testFiles/myKeysShort"), testExploitation);
    }

    /**
     * Test Long
     */
    private static void testSolutionLong() {
        String messagePath = "D:/testFiles/message_long";
        String keysPath = "D:/testFiles/myKeysLong";
        String cipherPath = "D:/testFiles/cipher_long";
        byte[] testCipher = Tools.encrypt(Paths.get(messagePath), Paths.get(keysPath));
        byte[] actualCipher = Tools.readFromFile(Paths.get(cipherPath));
        if (Arrays.equals(testCipher, actualCipher))
            System.out.println("Test Exploitation Long - PASSED !");
        else
            System.out.println("Test Exploitation Long - FAILED !");
    }

    /**
     * Test Short
     */
    private static void testSolutionShort() {
        String messagePath = "D:/testFiles/message_short";
        String keysPath = "D:/testFiles/myKeysShort";
        String cipherPath = "D:/testFiles/cipher_short";
        byte[] testCipher = Tools.encrypt(Paths.get(messagePath), Paths.get(keysPath));
        byte[] actualCipher = Tools.readFromFile(Paths.get(cipherPath));
        if (Arrays.equals(testCipher, actualCipher))
            System.out.println("Test Exploitation Short - PASSED !");
        else
            System.out.println("Test Exploitation Short - FAILED !");
    }
}
